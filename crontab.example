#!/bin/bash
# Example Crontab for Tenable to Splunk HEC Integration
# Copy this to your crontab with: crontab -e
# Replace /path/to/tenable-hec-integration with your actual path

# ============================================================================
# Tenable to Splunk HEC Integration - Cron Schedule
# ============================================================================

# Set PATH to ensure commands are found
PATH=/usr/local/bin:/usr/bin:/bin

# Optional: Email notifications on errors
# MAILTO=admin@example.com

# ============================================================================
# Option 1: Standard Schedule (Recommended)
# ============================================================================

# Scans - every hour at 5 minutes past
5 * * * * /path/to/tenable-hec-integration/cron_wrapper.sh tenable_scans.py

# Vulnerabilities - every 2 hours at 15 minutes past
15 */2 * * * /path/to/tenable-hec-integration/cron_wrapper.sh tenable_vulnerabilities.py

# Assets - daily at 3:30 AM
30 3 * * * /path/to/tenable-hec-integration/cron_wrapper.sh tenable_assets.py


# ============================================================================
# Option 2: High-Frequency Collection
# ============================================================================

# Scans - every 15 minutes
# */15 * * * * /path/to/tenable-hec-integration/cron_wrapper.sh tenable_scans.py

# Vulnerabilities - every 30 minutes
# */30 * * * * /path/to/tenable-hec-integration/cron_wrapper.sh tenable_vulnerabilities.py

# Assets - every 6 hours
# 0 */6 * * * /path/to/tenable-hec-integration/cron_wrapper.sh tenable_assets.py


# ============================================================================
# Option 3: Business Hours Only (Monday-Friday, 9 AM - 5 PM)
# ============================================================================

# Scans - every 30 minutes during business hours
# */30 9-17 * * 1-5 /path/to/tenable-hec-integration/cron_wrapper.sh tenable_scans.py

# Vulnerabilities - twice daily at 10 AM and 3 PM
# 0 10,15 * * 1-5 /path/to/tenable-hec-integration/cron_wrapper.sh tenable_vulnerabilities.py

# Assets - once per day at 8 AM, business days only
# 0 8 * * 1-5 /path/to/tenable-hec-integration/cron_wrapper.sh tenable_assets.py


# ============================================================================
# Option 4: Run All Scripts Together
# ============================================================================

# All scripts at 2 AM daily
# 0 2 * * * /path/to/tenable-hec-integration/run_all.sh --once


# ============================================================================
# Maintenance Tasks
# ============================================================================

# Clean up old log files (older than 30 days) - runs monthly on the 1st
0 0 1 * * find /path/to/tenable-hec-integration/logs -name "*.log" -mtime +30 -delete

# Restart Redis if it's not running (for userspace Redis without root)
# @reboot /home/YOUR_USERNAME/redis-local/redis-stable/src/redis-server /home/YOUR_USERNAME/redis-local/config/redis.conf


# ============================================================================
# Cron Time Format Reference
# ============================================================================
# * * * * * command
# │ │ │ │ │
# │ │ │ │ └─── Day of week (0-7, Sunday=0 or 7)
# │ │ │ └───── Month (1-12)
# │ │ └─────── Day of month (1-31)
# │ └───────── Hour (0-23)
# └─────────── Minute (0-59)
#
# Common examples:
# */15 * * * *     = Every 15 minutes
# 0 * * * *        = Every hour
# 0 */2 * * *      = Every 2 hours
# 0 9-17 * * *     = Every hour from 9 AM to 5 PM
# 0 0 * * *        = Daily at midnight
# 0 2 * * *        = Daily at 2 AM
# 0 0 * * 0        = Weekly on Sunday at midnight
# 0 0 1 * *        = Monthly on the 1st at midnight
# ============================================================================
