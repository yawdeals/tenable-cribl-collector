# ============================================================================
# TENABLE TO CRIBL COLLECTOR - CONFIGURATION
# ============================================================================
# Copy this file to .env and update with your actual credentials
# ============================================================================

# ----------------------------------------------------------------------------
# REQUIRED: Tenable.io API Credentials
# ----------------------------------------------------------------------------
# Get these from Tenable.io: Settings > My Account > API Keys
TENABLE_ACCESS_KEY=your_tenable_access_key_here
TENABLE_SECRET_KEY=your_tenable_secret_key_here
TENABLE_URL=https://cloud.tenable.com

# ----------------------------------------------------------------------------
# REQUIRED: Cribl HEC Endpoint
# ----------------------------------------------------------------------------
# Configure your Cribl HEC endpoint and authentication token
CRIBL_HEC_HOST=your_cribl_host_here
CRIBL_HEC_PORT=8088
CRIBL_HEC_TOKEN=your_cribl_hec_token_here
CRIBL_HEC_SSL_VERIFY=false

# ----------------------------------------------------------------------------
# PERFORMANCE: Batch & Concurrency Settings
# ----------------------------------------------------------------------------
# HEC_BATCH_SIZE: Events per batch (10,000 recommended for optimal performance)
HEC_BATCH_SIZE=10000

# MAX_EVENTS_PER_FEED: Limit events per feed (0=unlimited)
#   - Use 0 for production (unlimited - recommended)
#   - Use 50000-100000 for very large environments to limit runtime
MAX_EVENTS_PER_FEED=0

# MAX_CONCURRENT_FEEDS: Number of feeds to process simultaneously
#   - 0 = Sequential mode (one feed at a time)
#   - 2 = Recommended (balanced performance, safe for most environments)
#   - 3-10 = Advanced (only for powerful systems, Tenable allows max 10)
MAX_CONCURRENT_FEEDS=2

# ----------------------------------------------------------------------------
# CHECKPOINT MANAGEMENT
# ----------------------------------------------------------------------------
# CHECKPOINT_DIR: Directory for checkpoint files (tracks processed items)
CHECKPOINT_DIR=checkpoints

# CHECKPOINT_MAX_IDS: Maximum IDs to track per feed (100,000 recommended)
CHECKPOINT_MAX_IDS=100000

# CHECKPOINT_RETENTION_DAYS: Days to retain checkpoint data (30 recommended)
CHECKPOINT_RETENTION_DAYS=30

# ----------------------------------------------------------------------------
# PROCESS LOCK
# ----------------------------------------------------------------------------
# LOCK_DIR: Directory for process lock files
LOCK_DIR=locks

# LOCK_TIMEOUT: Seconds before lock is considered stale
#   - 600 = 10 minutes (small environments)
#   - 1200 = 20 minutes (medium environments - recommended)
#   - 1800 = 30 minutes (large environments)
LOCK_TIMEOUT=1200

# ----------------------------------------------------------------------------
# FEED-SPECIFIC SETTINGS
# ----------------------------------------------------------------------------
# DELETED_ASSET_SCAN_INTERVAL_HOURS: Hours between deleted asset scans
#   - 24 = Daily scan
#   - 168 = Weekly scan (recommended - resource intensive)
DELETED_ASSET_SCAN_INTERVAL_HOURS=168

# ----------------------------------------------------------------------------
# LOGGING
# ----------------------------------------------------------------------------
# LOG_LEVEL: Logging verbosity (DEBUG, INFO, WARNING, ERROR)
LOG_LEVEL=INFO

# SCAN_INTERVAL: Seconds between daemon runs (when using --daemon mode)
SCAN_INTERVAL=21600
