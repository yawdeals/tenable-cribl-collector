# ============================================
# TENABLE TO CRIBL HEC COLLECTOR CONFIGURATION
# ============================================

# ----------------
# REQUIRED SETTINGS
# ----------------

# Tenable.io API credentials
TENABLE_ACCESS_KEY=your_tenable_access_key_here
TENABLE_SECRET_KEY=your_tenable_secret_key_here

# Cribl HEC endpoint
CRIBL_HEC_HOST=your_cribl_host_here
CRIBL_HEC_TOKEN=your_cribl_hec_token_here

# ----------------
# OPTIONAL SETTINGS (defaults shown)
# ----------------

# Cribl HEC port and SSL
CRIBL_HEC_PORT=8088
CRIBL_HEC_SSL_VERIFY=true
CRIBL_HEC_CA_CERT=$CRIBL_HOME/local/cribl/auth/cribl.pem

# ----------------
# HEC THROUGHPUT SETTINGS
# Tune these based on your Cribl server capacity
# ----------------

# Batch size: events per HEC request (lower = less memory pressure on Cribl)
# Small server (4 CPU, 15GB): 1000-2000
# Medium server (8 CPU, 32GB): 3000-5000
# Large server (16+ CPU, 64GB+): 5000-10000
HEC_BATCH_SIZE=2000

# Batch delay: seconds between HEC requests (higher = less CPU pressure)
# Small server: 0.05-0.1 (50-100ms)
# Medium server: 0.01-0.05 (10-50ms)
# Large server: 0.005-0.01 (5-10ms)
HEC_BATCH_DELAY=0.05

# Connection pool size (lower = fewer concurrent connections to Cribl)
# Small server: 5
# Medium server: 10
# Large server: 20
HEC_POOL_CONNECTIONS=5
HEC_POOL_MAXSIZE=5

# Request timeout in seconds
HEC_REQUEST_TIMEOUT=30

# ----------------
# EXECUTION MODE
# ----------------

# Smart Grouping runs 3 groups in parallel, feeds within sequentially
# This is the fastest mode that prevents Tenable 429 errors
SMART_FEED_GROUPING=true

# Delay between feeds in same group (prevents Tenable rate limits)
INTER_FEED_DELAY=60

# ----------------
# LOGGING
# ----------------
LOG_LEVEL=INFO